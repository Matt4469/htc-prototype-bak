var _hiddenFamily,_hiddenIndex,_hiddenProduct,_hiddenCategory,_hiddenContent,_hiddenPopup,_productListFirstMainContainer,_productListFirstLevelItems,_problemListTitleContainer,_problemListFirstMainContainer,_carrierListContainer,_productListDetailItemHeight=0,_selectedProductName="",_selectedCategoryName="",_selectedContentTitle,_carrierExisted,_jumpToLastSection,productSection=function(){"use strict";var e={activeDetailItem:function(){_productListFirstMainContainer.find(".detail-item").addClass("active")},removeFamilyIconHighline:function(){_productListFirstMainContainer.find(".product-item").removeClass("selected")},highlineFamilyIconSelected:function(){e.removeFamilyIconHighline(),_productListFirstMainContainer.find('.product-item[data-family="'+_hiddenFamily.val()+'"]').addClass("selected")},removeProductIconHighline:function(){_productListFirstMainContainer.find(".detail-item .related-product-item").removeClass("selected")},highlineProductIconSelected:function(){var t,n=_productListFirstMainContainer.find(".detail-item .related-product-item");e.removeProductIconHighline(),t=n.filter('[data-pname="'+_hiddenIndex.val()+'"]'),t.length>0&&(t.addClass("selected"),_selectedProductName=t.find(".product-name").text())},addProductListPadding:function(){_productListFirstMainContainer.addClass("add-padding")},revmoveProductListPadding:function(){commonSetting.isMobile()||_productListFirstMainContainer.removeClass("add-padding")},familyIconClick:function(e){e.find("div.product-item").off("click").on("click",function(e){var t=!1;commonSetting.isMobile()?t=!0:$(this).hasClass("selected")||(t=!0),t&&(_hiddenPopup.val(""),_hiddenContent.val(""),_hiddenCategory.val(""),_hiddenProduct.val(""),_hiddenIndex.val(""),_hiddenFamily.val($(this).data("family")),contactSupport.pushParams())})},expandProductList:function(e,t,n){contactSupport.expandSecondLevelList(!0,e,t,function(e){n(e)})},setupCloseProductListForMobile:function(e){e.find(".detail-item .btn-close").off("click").on("click",function(){_hiddenPopup.val(""),_hiddenContent.val(""),_hiddenCategory.val(""),_hiddenProduct.val(""),_hiddenFamily.val(""),contactSupport.pushParams()})},showProductListSection:function(){$(".product-listing").addClass("showed")},productIconClick:function(e){var t=e.find(".related-product-item");e.find(".detail-item");t.length&&t.off("click").on("click",function(){var e=$(this).data("pname-id");void 0!==e?(t.removeClass("selected"),$(this).addClass("selected"),_selectedProductName=$(this).find(".product-name").text(),_selectedCategoryName="",carrierSection.hideCarrierSection(),_hiddenPopup.val(""),_hiddenContent.val(""),_hiddenCategory.val(""),_hiddenIndex.val($(this).data("pname")),_hiddenProduct.val(e),contactSupport.pushParams()):(_hiddenPopup.val(""),_hiddenContent.val(""),_hiddenCategory.val(""),_hiddenProduct.val(""),_hiddenIndex.val($(this).data("pname")),contactSupport.pushParams())})}};return e}(),carrierSection=function(){"use strict";var e={highlineCarrierNameSelected:function(){if(_carrierListContainer.find("li").length>0){var e=_carrierListContainer.find("li").filter('[data-pname-id="'+_hiddenProduct.val()+'"]');e.length>0&&(e.addClass("selected"),_selectedProductName=e.data("pname"))}},showCarrierSection:function(){$(".carrier-listing").addClass("showed")},hideCarrierSection:function(){$(".carrier-listing").removeClass("showed")},expandCarrierlist:function(){_carrierExisted=!1;var t=_productListFirstMainContainer.find(".product-item.selected .related-product-item"),n=t.filter('[data-pname="'+_hiddenIndex.val()+'"]'),i=n.find(".hidden-carrier-block");i.length>0&&(e.updateCarrierContainer(i.clone()),_carrierExisted=!0)},carrierNameClick:function(){_carrierListContainer.find("li").off("click").on("click",function(){var e=$(this).data("pname-id");_carrierListContainer.find("li").removeClass("selected"),$(this).addClass("selected"),_hiddenContent.val(""),_hiddenCategory.val(""),_hiddenProduct.val(e),contactSupport.pushParams()})},updateCarrierContainer:function(e){var t="";e.find("li").length<4&&(t="less-than-3-items"),e.find("li").removeClass("selected"),e.find("ul").addClass(t),_carrierListContainer.html(e.html())}};return e}(),problemSection=function(){"use strict";var e={activeDetailItem:function(){_problemListFirstMainContainer.find(".detail-item").addClass("active")},highlineCategoryIconSelected:function(){_problemListFirstMainContainer.find(".product-item").removeClass("selected");var e=_problemListFirstMainContainer.find('.product-item[data-category="'+_hiddenCategory.val()+'"]');void 0!==e&&(e.addClass("selected"),_selectedCategoryName=e.find(".product-name").text())},showProblemListSection:function(){$(".problem-listing").addClass("showed")},hideProblemListSection:function(){$(".problem-listing").removeClass("showed")},callProblemList:function(e,t){var n,i=_problemListFirstMainContainer,o="";o=commonSetting.isPrototypeHost()?"ek-assets/digital-first/json/list.json":"/"+$("body").data("site")+"/support/troubleshootingjson.aspx?p_name="+encodeURIComponent(e),n=$.ajax({url:o,method:"GET",dataType:"json",beforeSend:function(e){_jumpToLastSection=!1}}),n.done(function(e){if(void 0!==e.lineItem&&e.lineItem.length>0){var n=e.lineItem,o={problemArray:n};i.html(""),i.append(tmpl("problem-type-list",o)),t()}else _jumpToLastSection=!0,_selectedCategoryName="",i.html(""),_hiddenPopup.val(""),_hiddenContent.val("0"),_hiddenCategory.val("0"),contactSupport.pushParams(!1)}),n.fail(function(e,t){})},categoryIconClick:function(e){e.find("div.product-item").off("click").on("click",function(e){var t=!1;if(commonSetting.isMobile()?t=!0:$(this).hasClass("selected")||(t=!0),t){var n=$(this).data("category");_hiddenPopup.val(""),_hiddenContent.val(""),_hiddenCategory.val(n),void 0===e.originalEvent?contactSupport.pushParams(!1):contactSupport.pushParams()}})},unselectSingleContent:function(){_problemListFirstMainContainer.find(".single-content").removeClass("selected"),_problemListFirstMainContainer.find(".related-help-content-item.btn-need-more-help").removeClass("selected")},setupCloseContentListForMobile:function(e){e.find(".detail-item .btn-close").off("click").on("click",function(){_hiddenPopup.val(""),_hiddenContent.val(""),_hiddenCategory.val(""),contactSupport.pushParams()})},expandContentList:function(e,t,n){contactSupport.expandSecondLevelList(!0,e,t,function(e){n(e)})},singleContentClick:function(t){var n=t.find(".related-help-content-item.single-content");e.unselectSingleContent(),n.off("click").on("click",function(){var e=$(this).data("content-id");_hiddenPopup.val(""),_hiddenContent.val(e),contactSupport.pushParams()})},triggerFirstCategoryClick:function(){commonSetting.isMobile()||_problemListFirstMainContainer.find(".product-item").eq(0).trigger("click")},setupNeedMoreHelpClick:function(){e.unselectSingleContent(),$(".btn-need-more-help").off("click").on("click",function(){_hiddenPopup.val(""),$(this).hasClass("related-help-content-item")?_hiddenContent.val(0):(_hiddenContent.val(-1),commonSetting.isMobile()&&(_hiddenCategory.val(0),_selectedCategoryName="")),contactSupport.pushParams()})},updateProductName:function(e){_problemListTitleContainer.find("h4").find("span").text(e)},updateMobileTitleProductName:function(e){var t=_problemListTitleContainer.find("h4");t.find("span").text(e),_problemListFirstMainContainer.find(".m-popup-title").text(t.text())}};return e}(),contentSection=function(){"use strict";var e={resetEmailIconClick:function(e,t){$(".help-contact-list .email > a").off("click").on("click",function(n){n.preventDefault();var i;i=""!==t?$(this).attr("href")+"?pname="+encodeURIComponent(e)+"&pname_id="+encodeURIComponent(_hiddenProduct.val())+"&category_name="+encodeURIComponent(t)+"&category_id="+encodeURIComponent(_hiddenCategory.val()):$(this).attr("href")+"?pname="+encodeURIComponent(e)+"&pname_id="+encodeURIComponent(_hiddenProduct.val()),location.href=i})},highlineContentBlockSelected:function(){var e=_problemListFirstMainContainer.find('.single-content[data-content-id="'+_hiddenContent.val()+'"]');problemSection.unselectSingleContent(),e.length>0?(e.addClass("selected"),_selectedContentTitle=e.find(".product-help-info").eq(0).text()):"0"===_hiddenContent.val()&&_problemListFirstMainContainer.find(".related-help-content-item.btn-need-more-help").addClass("selected")},showMoreHelpSection:function(){$(".more-help-result").addClass("showed")},hideMoreHelpSection:function(){$(".more-help-result").removeClass("showed")},showContentAbstractSection:function(){$(".abstract-content").addClass("showed")},hideContentAbstractSection:function(){$(".abstract-content").removeClass("showed")},showPopup:function(){$(".popup-area").addClass("showed"),$("body").addClass("support-popup-fixed"),$(".popup-window").scrollTop(0)},hidePopup:function(){$(".popup-area").removeClass("showed"),$("body").removeClass("support-popup-fixed")},abstractContentClick:function(){$(".abstract-single-content-block").off("click").on("click",function(){_hiddenPopup.val("1"),contactSupport.pushParams()})},updateAbstractContent:function(t,n){e.callSingleContent(_hiddenProduct.val(),t,function(){n()})},popupSingleContent:function(){e.setupClosePopupBtn(),e.showPopup()},callSingleContent:function(t,n,i){var o,c="";c=commonSetting.isPrototypeHost()?"ek-assets/digital-first/json/content.json":"/"+$("body").data("site")+"/support/troubleshootingjson.aspx?p_name="+t+"&id="+n,o=$.ajax({url:c,method:"GET",dataType:"json"}),o.done(function(t){void 0!==t.content&&($(".single-article").html(t.content),e.buildAbstractContent(t.content),i())}),o.fail(function(e,t){})},buildAbstractContent:function(e){var t=$('<div class="temp-content-block"></div>');t.html(e);var n=t.text().substring(0,300);$(".abstract-content-block").text(n+"...")},buildSingleContentTitle:function(e){$(".abstract-single-content-block .title-block").text(e),$(".popup-article .popup-title").text(e)},buildSingleContentShortLink:function(){var e="#prototype";commonSetting.isPrototypeHost()||(e=location.protocol+"//"+location.host+"/"+$("body").data("site")+"/contact/productissue/"+_hiddenProduct.val()+"/"+_hiddenContent.val()+"/"),$(".go-to-page").attr("data-clipboard-text",e),new Clipboard(".go-to-page").on("success",function(e){$(".copy-msg").addClass("show"),e.clearSelection()})},hideCopiedMsgText:function(){$(".copy-msg").removeClass("show")},setupClosePopupBtn:function(){var t=$(".popup-area .btn-close");t.length>0&&t.off("click").on("click",function(){e.hidePopup(),_hiddenPopup.val(""),contactSupport.pushParams()})}};return e}(),contactSupport=function(){"use strict";var e={restorePageStatus:function(t){var n=$.Deferred();return productSection.addProductListPadding(),productSection.familyIconClick(_productListFirstMainContainer),t&&(_productListFirstMainContainer.find(".detail-item").remove(),carrierSection.hideCarrierSection(),problemSection.hideProblemListSection(),contentSection.hideContentAbstractSection(),contentSection.hideMoreHelpSection(),contentSection.hidePopup()),""!==_hiddenFamily.val()?(productSection.revmoveProductListPadding(),productSection.highlineFamilyIconSelected(),productSection.showProductListSection(),productSection.expandProductList(_productListFirstMainContainer,_hiddenFamily.val(),function(t){productSection.productIconClick(_productListFirstMainContainer),productSection.setupCloseProductListForMobile(_productListFirstMainContainer),""!==_hiddenIndex.val()?(productSection.activeDetailItem(),contentSection.hideMoreHelpSection(),contentSection.hideContentAbstractSection(),problemSection.hideProblemListSection(),productSection.highlineProductIconSelected(),carrierSection.expandCarrierlist(),_carrierExisted&&(carrierSection.carrierNameClick(),carrierSection.showCarrierSection()),""!==_hiddenProduct.val()?(carrierSection.highlineCarrierNameSelected(),problemSection.callProblemList(_hiddenProduct.val(),function(){problemSection.updateProductName(_selectedProductName),problemSection.categoryIconClick(_problemListFirstMainContainer),problemSection.showProblemListSection(),""!==_hiddenCategory.val()?"0"===_hiddenCategory.val()?(commonSetting.isMobile()&&(commonSetting.removeMobilePopupFix(),e.removeDetailItemForMobile(),contentSection.resetEmailIconClick(_selectedProductName,_selectedCategoryName)),contentSection.highlineContentBlockSelected(),contentSection.showMoreHelpSection(),n.resolve()):problemSection.expandContentList(_problemListFirstMainContainer,_hiddenCategory.val(),function(t){problemSection.highlineCategoryIconSelected(),problemSection.singleContentClick(_problemListFirstMainContainer),problemSection.setupCloseContentListForMobile(_problemListFirstMainContainer),problemSection.updateMobileTitleProductName(_selectedProductName),contentSection.resetEmailIconClick(_selectedProductName,_selectedCategoryName),problemSection.setupNeedMoreHelpClick(),""!==_hiddenContent.val()?(problemSection.activeDetailItem(),contentSection.hideContentAbstractSection(),contentSection.hideMoreHelpSection(),commonSetting.isMobile()&&(commonSetting.removeMobilePopupFix(),e.removeDetailItemForMobile()),"0"===_hiddenContent.val()||"-1"===_hiddenContent.val()?(contentSection.highlineContentBlockSelected(),contentSection.showMoreHelpSection(),n.resolve()):contentSection.updateAbstractContent(_hiddenContent.val(),function(){contentSection.highlineContentBlockSelected(),contentSection.buildSingleContentTitle(_selectedContentTitle),contentSection.hideCopiedMsgText(),contentSection.buildSingleContentShortLink(),contentSection.abstractContentClick(),contentSection.showContentAbstractSection(),""!==_hiddenPopup.val()?contentSection.popupSingleContent():n.resolve()})):n.resolve()}):commonSetting.isMobile()?(commonSetting.removeMobilePopupFix(),e.removeDetailItemForMobile(),problemSection.setupNeedMoreHelpClick(),n.resolve()):problemSection.triggerFirstCategoryClick()})):(commonSetting.isMobile()&&(commonSetting.removeMobilePopupFix(),e.removeDetailItemForMobile()),n.resolve())):n.resolve()})):(t&&productSection.removeFamilyIconHighline(),n.resolve()),n.promise()},setupClickStatus:function(){var t=$.Deferred();return""!==_hiddenPopup.val()?(contentSection.popupSingleContent(),t.resolve()):""!==_hiddenContent.val()?(contentSection.hideContentAbstractSection(),contentSection.hideMoreHelpSection(),commonSetting.isMobile()&&(commonSetting.removeMobilePopupFix(),e.removeDetailItemForMobile()),"0"===_hiddenContent.val()||"-1"===_hiddenContent.val()?(commonSetting.isMobile()&&(commonSetting.removeMobilePopupFix(),e.removeDetailItemForMobile()),_jumpToLastSection||contentSection.highlineContentBlockSelected(),contentSection.resetEmailIconClick(_selectedProductName,_selectedCategoryName),contentSection.showMoreHelpSection(),t.resolve()):contentSection.updateAbstractContent(_hiddenContent.val(),function(){contentSection.highlineContentBlockSelected(),contentSection.buildSingleContentTitle(_selectedContentTitle),contentSection.hideCopiedMsgText(),contentSection.buildSingleContentShortLink(),contentSection.abstractContentClick(),contentSection.showContentAbstractSection(),t.resolve()})):""!==_hiddenCategory.val()?problemSection.expandContentList(_problemListFirstMainContainer,_hiddenCategory.val(),function(e){contentSection.hideContentAbstractSection(),contentSection.hideMoreHelpSection(),problemSection.highlineCategoryIconSelected(),problemSection.unselectSingleContent(),productSection.highlineProductIconSelected(),carrierSection.highlineCarrierNameSelected(),problemSection.updateProductName(_selectedProductName),problemSection.singleContentClick(_problemListFirstMainContainer),problemSection.setupCloseContentListForMobile(_problemListFirstMainContainer),problemSection.updateMobileTitleProductName(_selectedProductName),contentSection.resetEmailIconClick(_selectedProductName,_selectedCategoryName),problemSection.setupNeedMoreHelpClick(),t.resolve()}):""!==_hiddenProduct.val()?(contentSection.hideContentAbstractSection(),contentSection.hideMoreHelpSection(),carrierSection.highlineCarrierNameSelected(),problemSection.callProblemList(_hiddenProduct.val(),function(){problemSection.updateProductName(_selectedProductName),problemSection.categoryIconClick(_problemListFirstMainContainer),problemSection.showProblemListSection(),commonSetting.isMobile()?(commonSetting.removeMobilePopupFix(),e.removeDetailItemForMobile(),problemSection.setupNeedMoreHelpClick(),t.resolve()):problemSection.triggerFirstCategoryClick()})):""!==_hiddenIndex.val()?(contentSection.hideMoreHelpSection(),contentSection.hideContentAbstractSection(),problemSection.hideProblemListSection(),productSection.highlineProductIconSelected(),carrierSection.expandCarrierlist(),carrierSection.carrierNameClick(),commonSetting.isMobile()&&(commonSetting.removeMobilePopupFix(),e.removeDetailItemForMobile()),_carrierExisted&&(carrierSection.carrierNameClick(),carrierSection.showCarrierSection()),t.resolve()):""!==_hiddenFamily.val()?(carrierSection.hideCarrierSection(),problemSection.hideProblemListSection(),contentSection.hideContentAbstractSection(),contentSection.hideMoreHelpSection(),productSection.revmoveProductListPadding(),productSection.highlineFamilyIconSelected(),productSection.showProductListSection(),productSection.expandProductList(_productListFirstMainContainer,_hiddenFamily.val(),function(e){productSection.productIconClick(_productListFirstMainContainer),productSection.setupCloseProductListForMobile(_productListFirstMainContainer),t.resolve()})):commonSetting.isMobile()&&(productSection.removeFamilyIconHighline(),commonSetting.removeMobilePopupFix(),e.removeDetailItemForMobile()),t.promise()},expandSecondLevelList:function(t,n,i,o){var c=n.find(".detail-item");_productListDetailItemHeight=0,commonSetting.isMobile()&&(commonSetting.removeMobilePopupFix(),e.removeDetailItemForMobile()),c.length>0?(_productListDetailItemHeight=c.height(),c.css("height",_productListDetailItemHeight).removeClass("active").html("")):c=$('<div class="detail-item"></div>'),n.find(".product-item").each(function(t,r){var d="family";if(n.parents("section").hasClass("problem-listing")&&(d="category"),$(this).data(d)===i){var a=$(this),l=t,s=e.appendAfterItem(l,n),p='<div class="related-product-group"><div class="btn-close"></div><div class="popup-title m-popup-title">'+$(".hidden-select-product-model").val()+"</div>"+$(this).find(".related-products").html()+"</div>";n.parents("section").hasClass("problem-listing")&&(p='<div class="related-product-group related-problem-group"><div class="btn-close"></div><div class="popup-title m-popup-title">'+$(".hidden-select-your-issue").val()+"</div>"+$(this).find(".related-products").html()+"</div>"),void 0===s?c.append(p).insertAfter(n.find(".product-item").last()):c.append(p).insertAfter(n.find(".product-item").eq(s)),commonSetting.isMobile()?((n.parents("section").hasClass("product-listing")&&""===_hiddenProduct.val()||n.parents("section").hasClass("problem-listing")&&""===_hiddenContent.val())&&commonSetting.addMobilePopupFix(),o(a)):(setTimeout(function(){commonSetting.addMobilePopupFix()},0),o(a))}})},scrollToLastSection:function(t){if($("section.showed").length>0){var n,i=$("section.showed").last();n=i.hasClass("product-listing")?i.find(".title h4"):i,e.screenScroll(i,n)}},screenScroll:function(e,t,n){var i,o=null,c=$(t).offset().top-70;i=new TimelineLite,e.hasClass("product-listing")||e.hasClass("problem-listing")?(o=e.find(".detail-item"),commonSetting.isMobile()||(i.add(TweenLite.set(o,{height:"auto"})),i.add(TweenLite.from(o,.5,{height:_productListDetailItemHeight}))),i.to(window,.5,{scrollTo:{y:c}},"-=0.45"),i.call(function(){o.addClass("active")},[],this,"-=0.40"),setTimeout(function(){i.play()},100)):setTimeout(function(){$("html, body").animate({scrollTop:c},500)},250)},itemsInRow:function(e){var t=0;return e.find(".product-item").each(function(){if($(this).prev().length>0){if($(this).position().top!==$(this).prev().position().top)return!1;t++}else t++}),t},detectAlignStart:function(t){e.itemsInRow(t),t.find(".product-item").length;t.removeClass("align-start")},appendAfterItem:function(t,n){for(var i=e.itemsInRow(n),o=1,c=i;c<n.find(".product-item").length;c+=i){if(t<c)return c-1;o+=1}},initObj:function(){_hiddenFamily=$(".hidden-seleted-family"),_hiddenIndex=$(".hidden-seleted-index"),_hiddenProduct=$(".hidden-seleted-product"),_hiddenCategory=$(".hidden-seleted-category"),_hiddenContent=$(".hidden-seleted-content"),_hiddenPopup=$(".hidden-seleted-popup"),_productListFirstMainContainer=$(".product-listing .flex-box-area"),_productListFirstLevelItems=_productListFirstMainContainer.find("div.product-item"),_problemListTitleContainer=$(".problem-listing .title"),_problemListFirstMainContainer=$(".problem-listing .flex-box-area"),_carrierListContainer=$(".carrier-listing .carrier-list-container")},updateHiddenInput:function(t){var n=$.url(),i=n.param("family"),o=n.param("index"),c=n.param("product"),r=n.param("categoryid"),d=n.param("content"),a=n.param("popup");e.initObj(),_hiddenFamily.val(""),_hiddenIndex.val(""),_hiddenProduct.val(""),_hiddenCategory.val(""),_hiddenContent.val(""),_hiddenPopup.val(""),void 0!==i&&(_hiddenFamily.val(i),void 0!==o&&_hiddenIndex.val(o),void 0!==c&&(_hiddenProduct.val(c),void 0!==r&&(_hiddenCategory.val(r),void 0!==d&&(_hiddenContent.val(d),void 0!==a&&_hiddenPopup.val(a))))),t()},pushParams:function(e){var t=_hiddenFamily.val(),n=_hiddenIndex.val(),i=_hiddenProduct.val(),o=_hiddenCategory.val(),c=_hiddenContent.val(),r=_hiddenPopup.val(),d="";void 0!==t&&t.length>0&&(d+="&family="+t),void 0!==n&&n.length>0&&(d+="&index="+n),void 0!==i&&i.length>0&&(d+="&product="+i),void 0!==o&&o.length>0&&(d+="&categoryid="+o),void 0!==c&&c.length>0&&(d+="&content="+c),void 0!==r&&r.length>0&&(d+="&popup="+r),void 0===e?History.pushState({rand:Math.random(),family:t,product:i,category:o,content:c},document.title,"?"+d):History.replaceState({rand:Math.random(),family:t,product:i,category:o,content:c},document.title,"?"+d)},removeDetailItemForMobile:function(){commonSetting.isMobile()&&$(".detail-item").remove()}};return e}();$(document).ready(function(){"use strict";contactSupport.updateHiddenInput(function(){$.when(contactSupport.restorePageStatus(!1)).then(function(){contactSupport.scrollToLastSection()})})}),$(window).bind("popstate",function(e){"use strict";void 0!==e.originalEvent?contactSupport.updateHiddenInput(function(){$.when(contactSupport.restorePageStatus(!0)).then(function(){contactSupport.scrollToLastSection()})}):contactSupport.updateHiddenInput(function(){$.when(contactSupport.setupClickStatus()).then(function(){contactSupport.scrollToLastSection()})})}),$(window).resize(function(){"use strict";commonSetting.forcePageReload()});