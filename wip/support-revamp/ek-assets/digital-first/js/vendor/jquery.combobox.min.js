!function(t){t.widget("ui.combobox",{_create:function(){var e=this,i=this.element.hide(),n=i.children(":selected"),o=n.val()?n.text():"",a=/^[^a-zA-Z0-9]*([a-zA-Z0-9])/i,c=i.children("option").map(function(){if(this.value){var i=t(this).text();return{label:e.options.label?e.options.label(this):i,value:i,option:this}}}),r=this.input=t("<input type='text' />").insertAfter(i).val(o).keydown(function(e){var n=t.ui.keyCode;switch(e.keyCode){case n.PAGE_UP:case n.PAGE_DOWN:case n.UP:case n.DOWN:case n.ENTER:case n.NUMPAD_ENTER:case n.TAB:case n.ESCAPE:break;default:if(e.stopImmediatePropagation(),e.keyCode<91&&e.keyCode>59||e.keyCode<58&&e.keyCode>47){var o,c=String.fromCharCode(e.keyCode).toLowerCase(),s=r.val(),u=i.children().filter(function(){var t=a.exec(this.text);return t&&2==t.length&&t[1].toLowerCase()==c});if(!u.length)return!1;if(s.length){var l=a.exec(s);l&&2==l.length&&l[1].toLowerCase()==c&&u.each(function(t,e){if(e.selected)return t+1<=u.length-1&&(o=u[t+1]),!1})}o||(o=u[0]),o.selected=!0,r.val(o.text),r.autocomplete("widget").is(":visible")&&r.data("autocomplete").widget().children("li").each(function(){var i=t(this);if(i.data("item.autocomplete").option==o)return r.data("autocomplete").menu.activate(e,i),!1})}return!1}}).autocomplete({delay:0,minLength:0,source:function(t,e){e(c)},select:function(t,i){i.item.option.selected=!0,e._trigger("selected",t,{item:i.item.option})},change:function(e,n){if(!n.item){var o=new RegExp("^"+t.ui.autocomplete.escapeRegex(t(this).val())+"$","i"),a=!1;if(i.children("option").each(function(){if(t(this).text().match(o))return this.selected=a=!0,!1}),!a)return t(this).val(""),i.val(""),r.data("autocomplete").term="",!1}}}).addClass("ui-widget ui-widget-content ui-corner-left").click(function(){e.button.click()}).bind("autocompleteopen",function(e,n){var o=i.children(":selected")[0];r.data("autocomplete").widget().children("li").each(function(){var i=t(this);if(i.data("item.autocomplete").option==o)return r.data("autocomplete").menu.activate(e,i),!1})});r.data("autocomplete")._renderItem=function(e,i){return t("<li></li>").data("item.autocomplete",i).append("<a href='#'>"+i.label+"</a>").appendTo(e)},r.css({width:function(){var e=n.parent(),i=e.clone();i.css({visibility:"hidden",width:"",height:"",maxWidth:"",maxHeight:""}),t("body").append(i);var o=i.outerWidth();return i.remove(),o+"px"}}),this.button=t("<button type='button'>&nbsp;</button>").attr("tabIndex",-1).attr("title","").insertAfter(r).button({icons:{primary:""},text:!1}).removeClass("ui-corner-all").addClass("ui-corner-right ui-button-icon").click(function(){if(r.autocomplete("widget").is(":visible"))return void r.autocomplete("close");r.autocomplete("search",""),r.focus()})},setValue:function(e){var i=this.input;t("option",this.element).each(function(){if(t(this).val()==e)return this.selected=!0,i.val(this.text),!1})},destroy:function(){this.input.remove(),this.button.remove(),this.element.show(),t.Widget.prototype.destroy.call(this)},resetWidth:function(){var e;(e=t.browser.msie?9==parseInt(t.browser.version,10)?this.element.find("option").length>5?this.input.width()+25:this.input.width()+42:this.element.find("option").length>5?this.input.width()+13:this.input.width()+30:this.input.width()+this.button.width()+29)>0&&(this.input.autocomplete("widget").css("min-width",e+"px"),this.input.autocomplete("widget").width(e))},getValue:function(){return this.element.val()},getEngName:function(){return this.element.find("option:selected").data("engname").toString()}})}(jQuery);