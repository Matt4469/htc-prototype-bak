var backupTransfer=function(){"use strict";var t,e={itemsInRow:function(){var t=0;return $(".product-item").each(function(){if($(this).prev().length>0){if($(this).position().top!==$(this).prev().position().top)return!1;t++}else t++}),t},detectAlignStart:function(){var t=e.itemsInRow(),i=$(".product-item").length;$(".flex-box-area").removeClass("align-start"),i%t!=0&&$(".flex-box-area").addClass("align-start")},appendAfterItem:function(t){for(var i=e.itemsInRow(),o=1,n=i;n<$(".product-item").length;n+=i){if(t<n)return n-1;o+=1}},scrollToSubItem:function(t){var e=$(".flex-box-area").find(".detail-item"),i=new TimelineLite;i.add(TweenLite.set(e,{height:"auto"})),i.add(TweenLite.from(e,.5,{height:t}),"-=0.5"),i.call(function(){e.addClass("active")},[],this,"-=0.2"),i.play()},collapseCarrier:function(){console.log("test");var t=$(".flex-box-area").find(".detail-item"),e=new TimelineLite;e.add(TweenLite.to(t,.5,{height:0}),"+=0.4"),e.call(function(){t.removeClass("active")},[],this),e.play()},expandList:function(t){var i=$(".flex-box-area").find(".detail-item"),o=0;i.length>0?(o=i.height(),i.css("height","auto").removeClass("active").html("")):i=$('<div class="detail-item"></div>'),$(".product-item").each(function(t,n){$(this);if($(this).hasClass("selected")){var a=t,s=$(this).find(".product-name").text(),r=e.appendAfterItem(a),c=($(this).find(".related-products").children("a").size(),'<div class="related-product-group popup-window"><div class="btn-close"></div><div class="popup-title m-popup-title">'+s+"</div>"+$(this).find(".related-products").html()+"</div>");void 0===r?i.append(c).insertAfter($(".product-item").last()):i.append(c).insertAfter($(".product-item").eq(r)),commonSetting.isMobile()?(i.addClass("active"),commonSetting.addMobilePopupFix()):e.scrollToSubItem(o),e.closeBtnClick(),commonSetting.addMobilePopupFix()}}),e.detectAlignStart()},restoreTopicSelection:function(i){$(".product-item").removeClass("selected"),$(".product-item").eq(t.val()).addClass("selected"),e.expandList(!0)},topicClick:function(){$(".product-item").off("click").on("click",function(i){$(this).hasClass("selected")||(t.val($(this).index()),e.pushParams())})},closeBtnClick:function(){$(".btn-close").click(function(){e.collapseCarrier(),t.val(""),e.pushParams()})},initObj:function(){t=$(".hidden-seleted-topic")},updateHiddenInput:function(i){var o=$.url(),n=o.param("topic");e.initObj(),t.val(""),void 0!==n&&t.val(n),i()},pushParams:function(){var e=t.val(),i="";void 0!==e&&e.length>0&&(i+="&topic="+e),History.pushState({rand:Math.random(),topic:e},document.title,"?"+i)},restorePageStatus:function(i){e.topicClick(),""!==t.val()?e.restoreTopicSelection(i):!commonSetting.isMobile()&&i?($(".product-item").eq(0).addClass("selected"),e.expandList(!1)):($(".detail-item").removeClass("active"),commonSetting.removeMobilePopupFix(),setTimeout(function(){$(".product-item").removeClass("selected"),$(".detail-item").remove()},500))}};return e}();$(window).resize(function(){"use strict";commonSetting.forcePageReload()}),$(document).ready(function(){"use strict"}),function(t,e){"use strict";"file:"===document.location.protocol&&alert("The HTML5 History API (and thus History.js) do not work on files, please upload it to a server."),backupTransfer.updateHiddenInput(function(){backupTransfer.restorePageStatus(!0)}),History.Adapter.bind(t,"statechange",function(){History.getState();backupTransfer.updateHiddenInput(function(){backupTransfer.restorePageStatus(!1)})})}(window);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImJhY2t1cC10cmFuc2Zlci5qcyJdLCJuYW1lcyI6WyJiYWNrdXBUcmFuc2ZlciIsIl9oaWRkZW5Ub3BpYyIsIml0ZW1zSW5Sb3ciLCJsaXNJblJvdyIsIiQiLCJlYWNoIiwidGhpcyIsInByZXYiLCJsZW5ndGgiLCJwb3NpdGlvbiIsInRvcCIsImRldGVjdEFsaWduU3RhcnQiLCJpdGVtc0V2ZXJ5Um93IiwidG90YWxQcm9kdWN0cyIsInJlbW92ZUNsYXNzIiwiYWRkQ2xhc3MiLCJhcHBlbmRBZnRlckl0ZW0iLCJpZHgiLCJyZXN1bHRSb3ciLCJpIiwic2Nyb2xsVG9TdWJJdGVtIiwiZGV0YWlsSXRlbUhlaWdodCIsIiRjYXJyaWVyIiwiZmluZCIsInRpbWVMaW5lT2JqIiwiVGltZWxpbmVMaXRlIiwiYWRkIiwiVHdlZW5MaXRlIiwic2V0IiwiaGVpZ2h0IiwiZnJvbSIsImNhbGwiLCJwbGF5IiwiY29sbGFwc2VDYXJyaWVyIiwiY29uc29sZSIsImxvZyIsInRvIiwiZXhwYW5kTGlzdCIsInNsaWRlQW5pbWF0aW9uIiwiZGV0YWlsSXRlbXNDb250YWluZXIiLCJjc3MiLCJodG1sIiwiaW5kZXgiLCJlbCIsImhhc0NsYXNzIiwiY3VycmVudEluZGV4Iiwic2VsZWN0ZWRUaXRsZSIsInRleHQiLCJhcHBlbmRJdGVtSW5kZXgiLCJhcHBlbmRIdG1sIiwiY2hpbGRyZW4iLCJzaXplIiwiYXBwZW5kIiwiaW5zZXJ0QWZ0ZXIiLCJsYXN0IiwiZXEiLCJjb21tb25TZXR0aW5nIiwiaXNNb2JpbGUiLCJhZGRNb2JpbGVQb3B1cEZpeCIsImNsb3NlQnRuQ2xpY2siLCJyZXN0b3JlVG9waWNTZWxlY3Rpb24iLCJpbml0aWFsIiwidmFsIiwidG9waWNDbGljayIsIm9mZiIsIm9uIiwiZXZlbnQiLCJwdXNoUGFyYW1zIiwiY2xpY2siLCJpbml0T2JqIiwidXBkYXRlSGlkZGVuSW5wdXQiLCJjYWxsYmFjayIsInVybCIsInBhcmFtVG9waWMiLCJwYXJhbSIsInNlbGVjdGVkVG9waWMiLCJ1cmxQYXRoIiwiSGlzdG9yeSIsInB1c2hTdGF0ZSIsInJhbmQiLCJNYXRoIiwicmFuZG9tIiwidG9waWMiLCJkb2N1bWVudCIsInRpdGxlIiwicmVzdG9yZVBhZ2VTdGF0dXMiLCJyZW1vdmVNb2JpbGVQb3B1cEZpeCIsInNldFRpbWVvdXQiLCJyZW1vdmUiLCJ3aW5kb3ciLCJyZXNpemUiLCJmb3JjZVBhZ2VSZWxvYWQiLCJyZWFkeSIsInVuZGVmaW5lZCIsImxvY2F0aW9uIiwicHJvdG9jb2wiLCJhbGVydCIsIkFkYXB0ZXIiLCJiaW5kIiwiZ2V0U3RhdGUiXSwibWFwcGluZ3MiOiJBQUNBLEdBQUlBLGdCQUFrQixXQUNsQixZQUNBLElBQUlDLEdBTUFELEdBQ0FFLFdBQVksV0FDUixHQUFJQyxHQUFXLENBWWYsT0FYQUMsR0FBRSxpQkFBaUJDLEtBQUssV0FFcEIsR0FBSUQsRUFBRUUsTUFBTUMsT0FBT0MsT0FBUyxFQUFHLENBQzNCLEdBQUlKLEVBQUVFLE1BQU1HLFdBQVdDLE1BQVFOLEVBQUVFLE1BQU1DLE9BQU9FLFdBQVdDLElBQ3JELE9BQU8sQ0FFWFAsU0FFQUEsT0FHREEsR0FFWFEsaUJBQWtCLFdBQ2QsR0FBSUMsR0FBZ0JaLEVBQWVFLGFBQy9CVyxFQUFnQlQsRUFBRSxpQkFBaUJJLE1BQ3ZDSixHQUFFLGtCQUFrQlUsWUFBWSxlQUM1QkQsRUFBZ0JELEdBQWtCLEdBQ2xDUixFQUFFLGtCQUFrQlcsU0FBUyxnQkFHckNDLGdCQUFpQixTQUFTQyxHQUl0QixJQUFLLEdBSERMLEdBQWdCWixFQUFlRSxhQUMvQmdCLEVBQVksRUFFUEMsRUFBSVAsRUFBZU8sRUFBSWYsRUFBRSxpQkFBaUJJLE9BQVFXLEdBQUtQLEVBQWUsQ0FFM0UsR0FBSUssRUFBTUUsRUFDTixNQUFPQSxHQUFJLENBRVhELElBQWEsSUFJekJFLGdCQUFpQixTQUFTQyxHQUV0QixHQUNJQyxHQUFXbEIsRUFBRSxrQkFBa0JtQixLQUFLLGdCQUNwQ0MsRUFBYyxHQUFJQyxhQUt0QkQsR0FBWUUsSUFBSUMs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LEdBQzdCekQsRUFBRSxpQkFBaUJtRCxHQUFHLEdBQUd4QyxTQUFTLFlBQ2xDZixFQUFlcUMsWUFBVyxLQUUxQmpDLEVBQUUsZ0JBQWdCVSxZQUFZLFVBQzlCMEMsY0FBYzhCLHVCQUNkQyxXQUFXLFdBQ1BuRixFQUFFLGlCQUFpQlUsWUFBWSxZQUMvQlYsRUFBRSxnQkFBZ0JvRixVQUNuQixPQU1uQixPQUFPeEYsS0FHWEksR0FBRXFGLFFBQVFDLE9BQU8sV0FDYixZQUNBbEMsZUFBY21DLG9CQUdsQnZGLEVBQUUrRSxVQUFVUyxNQUFNLFdBQ2QsZUFHSixTQUFVSCxFQUFRSSxHQUNkLFlBRW1DLFdBQS9CVixTQUFTVyxTQUFTQyxVQUNsQkMsTUFBTSxtR0FHVmhHLGVBQWVzRSxrQkFBa0IsV0FDN0J0RSxlQUFlcUYsbUJBQWtCLEtBSXJDUixRQUFRb0IsUUFBUUMsS0FBS1QsRUFBUSxjQUFlLFdBQzVCWixRQUFRc0IsVUFFcEJuRyxnQkFBZXNFLGtCQUFrQixXQUM3QnRFLGVBQWVxRixtQkFBa0IsUUFJMUNJIiwiZmlsZSI6ImJhY2t1cC10cmFuc2Zlci5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qIGdsb2JhbCBzZWFyY2hEYXRhLCBjb21tb25TZXR0aW5nLCBIaXN0b3J5LCBUaW1lbGluZUxpdGUsIFR3ZWVuTGl0ZSAqL1xudmFyIGJhY2t1cFRyYW5zZmVyID0gKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcbiAgICB2YXIgX2hpZGRlblRvcGljLFxuICAgICAgICBzZXR0aW5nPXtcbiAgICAgICAgICAgICdjbHNOYW1lQ29udGFpbmVyJzogJy5iYWNrdXAtdHJhbnNmZXItbGlzdCdcbiAgICAgICAgfTtcblxuXG4gICAgdmFyIGJhY2t1cFRyYW5zZmVyID0ge1xuICAgICAgICBpdGVtc0luUm93OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciBsaXNJblJvdyA9IDA7XG4gICAgICAgICAgICAkKCcucHJvZHVjdC1pdGVtJykuZWFjaChmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgICAgIGlmICgkKHRoaXMpLnByZXYoKS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICgkKHRoaXMpLnBvc2l0aW9uKCkudG9wICE9PSAkKHRoaXMpLnByZXYoKS5wb3NpdGlvbigpLnRvcCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGxpc0luUm93Kys7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgbGlzSW5Sb3crKztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBsaXNJblJvdztcbiAgICAgICAgfSxcbiAgICAgICAgZGV0ZWN0QWxpZ25TdGFydDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2YXIgaXRlbXNFdmVyeVJvdyA9IGJhY2t1cFRyYW5zZmVyLml0ZW1zSW5Sb3coKSxcbiAgICAgICAgICAgICAgICB0b3RhbFByb2R1Y3RzID0gJCgnLnByb2R1Y3QtaXRlbScpLmxlbmd0aDtcbiAgICAgICAgICAgICQoJy5mbGV4LWJveC1hcmVhJykucmVtb3ZlQ2xhc3MoJ2FsaWduLXN0YXJ0Jyk7XG4gICAgICAgICAgICBpZiAodG90YWxQcm9kdWN0cyAlIGl0ZW1zRXZlcnlSb3cgIT09IDApIHtcbiAgICAgICAgICAgICAgICAkKCcuZmxleC1ib3gtYXJlYScpLmFkZENsYXNzKCdhbGlnbi1zdGFydCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBhcHBlbmRBZnRlckl0ZW06IGZ1bmN0aW9uKGlkeCkge1xuICAgICAgICAgICAgdmFyIGl0ZW1zRXZlcnlSb3cgPSBiYWNrdXBUcmFuc2Zlci5pdGVtc0luUm93KCksXG4gICAgICAgICAgICAgICAgcmVzdWx0Um93ID0gMTtcblxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IGl0ZW1zRXZlcnlSb3c7IGkgPCAkKCcucHJvZHVjdC1pdGVtJykubGVuZ3RoOyBpICs9IGl0ZW1zRXZlcnlSb3cpIHtcbiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygnaWR4PScgKyBpZHggKyBcIiA8IGk9XCIgKyBpKTtcbiAgICAgICAgICAgICAgICBpZiAoaWR4IDwgaSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gaSAtIDE7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0Um93ICs9IDE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBzY3JvbGxUb1N1Ykl0ZW06IGZ1bmN0aW9uKGRldGFpbEl0ZW1IZWlnaHQpIHtcblxuICAgICAgICAgICAgdmFyIGhlYWRlckhlaWdodCA9IDcwLFxuICAgICAgICAgICAgICAgICRjYXJyaWVyID0gJCgnLmZsZXgtYm94LWFyZWEnKS5maW5kKCcuZGV0YWlsLWl0ZW0nKSxcbiAgICAgICAgICAgICAgICB0aW1lTGluZU9iaiA9IG5ldyBUaW1lbGluZUxpdGUoKTtcblxuICAgICAgICAgICAgLy9zY3JvbGwgdG8gZmFtaWx5IHNlY3Rpb25cbiAgICAgICAgICAgIC8vdGltZUxpbmVPYmouYWRkKFR3ZWVuTGl0ZS50byh3aW5kb3csIDAuNSwgeyBzY3JvbGxUbzogeyB5OiBzZXR0aW5nLmNsc05hbWVDb250YWluZXIsIG9mZnNldFk6IGhlYWRlckhlaWdodCB9IH0pKTtcbiAgICAgICAgICAgIC8vZXhwYW5kIHByb2R1Y3QgZGV0YWlsIGxpc3RcbiAgICAgICAgICAgIHRpbWVMaW5lT2JqLmFkZChUd2VlbkxpdGUuc2V0KCRjYXJyaWVyLCB7IGhlaWdodDogJ2F1dG8nIH0pKTtcbiAgICAgICAgICAgIHRpbWVMaW5lT2JqLmFkZChUd2VlbkxpdGUuZnJvbSgkY2FycmllciwgMC41LCB7IGhlaWdodDogZGV0YWlsSXRlbUhlaWdodCB9KSwgJy09MC41Jyk7XG4gICAgICAgICAgICAvL3Nob3cgcHJvZHVjdCBpdGVtc1xuICAgICAgICAgICAgdGltZUxpbmVPYmouY2FsbChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAkY2Fycmllci5hZGRDbGFzcygnYWN0aXZlJyk7XG4gICAgICAgICAgICB9LCBbXSwgdGhpcywgJy09MC4yJyk7XG4gICAgICAgICAgICAvL3N0YXJ0IFxuICAgICAgICAgICAgdGltZUxpbmVPYmoucGxheSgpO1xuXG4gICAgICAgIH0sXG4gICAgICAgIGNvbGxhcHNlQ2FycmllcjogZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCd0ZXN0Jyk7XG4gICAgICAgICAgICB2YXIgJGNhcnJpZXIgPSAkKCcuZmxleC1ib3gtYXJlYScpLmZpbmQoJy5kZXRhaWwtaXRlbScpLFxuICAgICAgICAgICAgICAgIHRpbWVMaW5lT2JqID0gbmV3IFRpbWVsaW5lTGl0ZSgpO1xuICAgICAgICAgICAgLy9leHBhbmQgcHJvZHVjdCBkZXRhaWwgbGlzdFxuICAgICAgICAgICAgXG4gICAgICAgICAgICB0aW1lTGluZU9iai5hZGQoVHdlZW5MaXRlLnRvKCRjYXJyaWVyLCAwLjUsIHsgaGVpZ2h0OiAwIH0pLCAnKz0wLjQnKTtcbiAgICAgICAgICAgIC8vc2hvdyBwcm9kdWN0IGl0ZW1zXG4gICAgICAgICAgICB0aW1lTGluZU9iai5jYWxsKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICRjYXJyaWVyLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcbiAgICAgICAgICAgIH0sIFtdLCB0aGlzKTtcbiAgICAgICAgICAgIC8vc3RhcnQgXG4gICAgICAgICAgICB0aW1lTGluZU9iai5wbGF5KCk7XG4gICAgICAgIH0sXG4gICAgICAgIGV4cGFuZExpc3Q6IGZ1bmN0aW9uKHNsaWRlQW5pbWF0aW9uKSB7XG4gICAgICAgICAgICB2YXIgZGV0YWlsSXRlbXNDb250YWluZXIgPSAkKCcuZmxleC1ib3gtYXJlYScpLmZpbmQoJy5kZXRhaWwtaXRlbScpLFxuICAgICAgICAgICAgICAgIGRldGFpbEl0ZW1IZWlnaHQgPSAwO1xuXG4gICAgICAgICAgICBpZiAoZGV0YWlsSXRlbXNDb250YWluZXIubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIGRldGFpbEl0ZW1IZWlnaHQgPSBkZXRhaWxJdGVtc0NvbnRhaW5lci5oZWlnaHQoKTtcbiAgICAgICAgICAgICAgICBkZXRhaWxJdGVtc0NvbnRhaW5lci5jc3MoJ2hlaWdodCcsICdhdXRvJykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpLmh0bWwoJycpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBkZXRhaWxJdGVtc0NvbnRhaW5lciA9ICQoJzxkaXYgY2xhc3M9XCJkZXRhaWwtaXRlbVwiPjwvZGl2PicpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAkKCcucHJvZHVjdC1pdGVtJykuZWFjaChmdW5jdGlvbihpbmRleCwgZWwpIHtcbiAgICAgICAgICAgICAgICAvKiBpdGVyYXRlIHRocm91Z2ggYXJyYXkgb3Igb2JqZWN0ICovXG4gICAgICAgICAgICAgICAgdmFyIGN1cnJlbnRJdGVtID0gJCh0aGlzKTtcbiAgICAgICAgICAgICAgICBpZiAoJCh0aGlzKS5oYXNDbGFzcygnc2VsZWN0ZWQnKSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgY3VycmVudEluZGV4ID0gaW5kZXgsXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZFRpdGxlID0gJCh0aGlzKS5maW5kKCcucHJvZHVjdC1uYW1lJykudGV4dCgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgYXBwZW5kSXRlbUluZGV4ID0gYmFja3VwVHJhbnNmZXIuYXBwZW5kQWZ0ZXJJdGVtKGN1cnJlbnRJbmRleCksXG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtTGVuZ3RoID0gJCh0aGlzKS5maW5kKCcucmVsYXRlZC1wcm9kdWN0cycpLmNoaWxkcmVuKCdhJykuc2l6ZSgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NDb3VudEl0ZW1zID0gJ2RldGFpbC1pdGVtJyArIGl0ZW1MZW5ndGgsXG4gICAgICAgICAgICAgICAgICAgICAgICBhcHBlbmRIdG1sID0gJzxkaXYgY2xhc3M9XCJyZWxhdGVkLXByb2R1Y3QtZ3JvdXAgcG9wdXAtd2luZG93XCI+PGRpdiBjbGFzcz1cImJ0bi1jbG9zZVwiPjwvZGl2PjxkaXYgY2xhc3M9XCJwb3B1cC10aXRsZSBtLXBvcHVwLXRpdGxlXCI+JyArIHNlbGVjdGVkVGl0bGUgKyAnPC9kaXY+JyArICQodGhpcykuZmluZCgnLnJlbGF0ZWQtcHJvZHVjdHMnKS5odG1sKCkgKyAnPC9kaXY+JztcblxuICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGFwcGVuZEl0ZW1JbmRleCA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRldGFpbEl0ZW1zQ29udGFpbmVyLmFwcGVuZChhcHBlbmRIdG1sKS5pbnNlcnRBZnRlcigkKCcucHJvZHVjdC1pdGVtJykubGFzdCgpKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRldGFpbEl0ZW1zQ29udGFpbmVyLmFwcGVuZChhcHBlbmRIdG1sKS5pbnNlcnRBZnRlcigkKCcucHJvZHVjdC1pdGVtJykuZXEoYXBwZW5kSXRlbUluZGV4KSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgXG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbW1vblNldHRpbmcuaXNNb2JpbGUoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGV0YWlsSXRlbXNDb250YWluZXIuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29tbW9uU2V0dGluZy5hZGRNb2JpbGVQb3B1cEZpeCgpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgYmFja3VwVHJhbnNmZXIuc2Nyb2xsVG9TdWJJdGVtKGRldGFpbEl0ZW1IZWlnaHQpO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgYmFja3VwVHJhbnNmZXIuY2xvc2VCdG5DbGljaygpO1xuICAgICAgICAgICAgICAgICAgICBjb21tb25TZXR0aW5nLmFkZE1vYmlsZVBvcHVwRml4KCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGJhY2t1cFRyYW5zZmVyLmRldGVjdEFsaWduU3RhcnQoKTtcbiAgICAgICAgfSxcbiAgICAgICAgcmVzdG9yZVRvcGljU2VsZWN0aW9uOiBmdW5jdGlvbihpbml0aWFsKSB7XG4gICAgICAgICAgICAkKCcucHJvZHVjdC1pdGVtJykucmVtb3ZlQ2xhc3MoJ3NlbGVjdGVkJyk7XG4gICAgICAgICAgICAkKCcucHJvZHVjdC1pdGVtJykuZXEoX2hpZGRlblRvcGljLnZhbCgpKS5hZGRDbGFzcygnc2VsZWN0ZWQnKTtcblxuICAgICAgICAgICAgYmFja3VwVHJhbnNmZXIuZXhwYW5kTGlzdCh0cnVlKTtcbiAgICAgICAgfSxcbiAgICAgICAgdG9waWNDbGljazogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAkKCcucHJvZHVjdC1pdGVtJykub2ZmKCdjbGljaycpLm9uKCdjbGljaycsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgICAgICAgICAgLyogQWN0IG9uIHRoZSBldmVudCAqL1xuICAgICAgICAgICAgICAgIGlmICghJCh0aGlzKS5oYXNDbGFzcygnc2VsZWN0ZWQnKSkge1xuICAgICAgICAgICAgICAgICAgICBfaGlkZGVuVG9waWMudmFsKCQodGhpcykuaW5kZXgoKSk7XG4gICAgICAgICAgICAgICAgICAgIGJhY2t1cFRyYW5zZmVyLnB1c2hQYXJhbXMoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSxcbiAgICAgICAgY2xvc2VCdG5DbGljazogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKCd0ZXN0Jyk7XG4gICAgICAgICAgICAkKCcuYnRuLWNsb3NlJykuY2xpY2soZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgYmFja3VwVHJhbnNmZXIuY29sbGFwc2VDYXJyaWVyKCk7XG4gICAgICAgICAgICAgICAgX2hpZGRlblRvcGljLnZhbCgnJyk7XG4gICAgICAgICAgICAgICAgYmFja3VwVHJhbnNmZXIucHVzaFBhcmFtcygpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sXG4gICAgICAgIC8vc3RhdGVVUGRhdGVcbiAgICAgICAgaW5pdE9iajogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBfaGlkZGVuVG9waWMgPSAkKCcuaGlkZGVuLXNlbGV0ZWQtdG9waWMnKTtcbiAgICAgICAgfSxcbiAgICAgICAgdXBkYXRlSGlkZGVuSW5wdXQ6IGZ1bmN0aW9uKGNhbGxiYWNrKSB7XG4gICAgICAgICAgICB2YXIgdXJsID0gJC51cmwoKSxcbiAgICAgICAgICAgICAgICBwYXJhbVRvcGljID0gdXJsLnBhcmFtKCd0b3BpYycpO1xuXG4gICAgICAgICAgICBiYWNrdXBUcmFuc2Zlci5pbml0T2JqKCk7XG5cbiAgICAgICAgICAgIF9oaWRkZW5Ub3BpYy52YWwoJycpO1xuXG4gICAgICAgICAgICBpZiAodHlwZW9mIHBhcmFtVG9waWMgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICAgICAgX2hpZGRlblRvcGljLnZhbChwYXJhbVRvcGljKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vdXBkYXRlIGhpZGRlbiBpcHV0cyBhbmQgdGhlblxuICAgICAgICAgICAgY2FsbGJhY2soKTtcbiAgICAgICAgfSxcbiAgICAgICAgcHVzaFBhcmFtczogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2YXIgc2VsZWN0ZWRUb3BpYyA9IF9oaWRkZW5Ub3BpYy52YWwoKSxcbiAgICAgICAgICAgICAgICB1cmxQYXRoID0gJyc7XG4gICAgICAgICAgICBpZiAodHlwZW9mIHNlbGVjdGVkVG9waWMgIT09ICd1bmRlZmluZWQnICYmIHNlbGVjdGVkVG9waWMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIHVybFBhdGggKz0gJyZ0b3BpYz0nICsgc2VsZWN0ZWRUb3BpYztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gaWYgKHVybFBhdGgubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgLy8gICAgIHVybFBhdGggPSAnPycgKyB1cmxQYXRoLnN1YnN0cmluZygxLCB1cmxQYXRoLmxlbmd0aCk7XG4gICAgICAgICAgICAvLyB9XG5cbiAgICAgICAgICAgIEhpc3RvcnkucHVzaFN0YXRlKHsgcmFuZDogTWF0aC5yYW5kb20oKSwgdG9waWM6IHNlbGVjdGVkVG9waWMgfSwgZG9jdW1lbnQudGl0bGUsICc/JyArIHVybFBhdGgpO1xuICAgICAgICB9LFxuICAgICAgICByZXN0b3JlUGFnZVN0YXR1czogZnVuY3Rpb24oaW5pdGlhbCkge1xuICAgICAgICAgICAgYmFja3VwVHJhbnNmZXIudG9waWNDbGljaygpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZygnX2hpZGRlblRvcGljLnZhbCgpPScgKyBfaGlkZGVuVG9waWMudmFsKCkpO1xuICAgICAgICAgICAgaWYgKF9oaWRkZW5Ub3BpYy52YWwoKSAhPT0gJycpIHtcbiAgICAgICAgICAgICAgICBiYWNrdXBUcmFuc2Zlci5yZXN0b3JlVG9waWNTZWxlY3Rpb24oaW5pdGlhbCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmICghY29tbW9uU2V0dGluZy5pc01vYmlsZSgpICYmIGluaXRpYWwpIHtcbiAgICAgICAgICAgICAgICAgICAgJCgnLnByb2R1Y3QtaXRlbScpLmVxKDApLmFkZENsYXNzKCdzZWxlY3RlZCcpO1xuICAgICAgICAgICAgICAgICAgICBiYWNrdXBUcmFuc2Zlci5leHBhbmRMaXN0KGZhbHNlKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAkKCcuZGV0YWlsLWl0ZW0nKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XG4gICAgICAgICAgICAgICAgICAgIGNvbW1vblNldHRpbmcucmVtb3ZlTW9iaWxlUG9wdXBGaXgoKTtcbiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICQoJy5wcm9kdWN0LWl0ZW0nKS5yZW1vdmVDbGFzcygnc2VsZWN0ZWQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICQoJy5kZXRhaWwtaXRlbScpLnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgICAgICB9LCA1MDApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG5cbiAgICByZXR1cm4gYmFja3VwVHJhbnNmZXI7XG59KCkpO1xuXG4kKHdpbmRvdykucmVzaXplKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcbiAgICBjb21tb25TZXR0aW5nLmZvcmNlUGFnZVJlbG9hZCgpO1xufSk7XG5cbiQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0Jztcbn0pO1xuXG4oZnVuY3Rpb24od2luZG93LCB1bmRlZmluZWQpIHtcbiAgICAndXNlIHN0cmljdCc7XG4gICAgLy8gQ2hlY2sgTG9jYXRpb25cbiAgICBpZiAoZG9jdW1lbnQubG9jYXRpb24ucHJvdG9jb2wgPT09ICdmaWxlOicpIHtcbiAgICAgICAgYWxlcnQoJ1RoZSBIVE1MNSBIaXN0b3J5IEFQSSAoYW5kIHRodXMgSGlzdG9yeS5qcykgZG8gbm90IHdvcmsgb24gZmlsZXMsIHBsZWFzZSB1cGxvYWQgaXQgdG8gYSBzZXJ2ZXIuJyk7XG4gICAgfVxuXG4gICAgYmFja3VwVHJhbnNmZXIudXBkYXRlSGlkZGVuSW5wdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgIGJhY2t1cFRyYW5zZmVyLnJlc3RvcmVQYWdlU3RhdHVzKHRydWUpO1xuXG4gICAgfSk7XG5cbiAgICBIaXN0b3J5LkFkYXB0ZXIuYmluZCh3aW5kb3csICdzdGF0ZWNoYW5nZScsIGZ1bmN0aW9uKCkgeyAvLyBOb3RlOiBXZSBhcmUgdXNpbmcgc3RhdGVjaGFuZ2UgaW5zdGVhZCBvZiBwb3BzdGF0ZVxuICAgICAgICB2YXIgU3RhdGUgPSBIaXN0b3J5LmdldFN0YXRlKCk7XG5cbiAgICAgICAgYmFja3VwVHJhbnNmZXIudXBkYXRlSGlkZGVuSW5wdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBiYWNrdXBUcmFuc2Zlci5yZXN0b3JlUGFnZVN0YXR1cyhmYWxzZSk7XG4gICAgICAgIH0pO1xuICAgIH0pO1xuXG59KSh3aW5kb3cpOyJdfQ==
