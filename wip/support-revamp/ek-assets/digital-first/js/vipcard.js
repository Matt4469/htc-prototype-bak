function addValidateRule(){"use strict";$("[id*=txt_sNAME]").rules("add",{required:!0}),$("[id*=txt_sNAME]").rules("add",{specialchars:!0}),$("[id*=txt_sPhoneNum]").rules("add",{required:!0}),$("[id*=txt_sPhoneNum]").rules("add",{numberonly:!0}),$("[id*=txt_sEamil]").rules("add",{required:!0}),$("[id*=txt_sEamil]").rules("add",{emailformat:!0}),$("[id*=txt_Address]").rules("add",{required:!0}),$("[id*=txt_Address]").rules("add",{specialcharsaddress:!0}),$("[id*=txt_sDesx]").rules("add",{required:!0})}function ReflashValidateImage(){"use strict";ajaxGetVCode()}function ajaxGetVCode(){"use strict";$.ajax({url:"/cn/support/captcahimg.aspx?act=ref&res=v",dataType:"html",type:"POST",error:function(){},success:function(e){vcode=e,$("#ctl00_ContentPlaceHolder1_Image1").attr("src","/cn/support/captcahimg.aspx")}})}function popupMsg(e){"use strict";$.confirm({title:"",message:e,buttons:{OK:{class:"blue-button",text:"OK"}}})}function popupMsgReload(e){"use strict";$.confirm({title:"",message:e,buttons:{OK:{class:"blue-button",text:"OK",action:function(){location.href=location.href}}}})}function popupAlertMsg(e,t){"use strict";$.confirm({title:e,message:t,buttons:{OK:{class:"blue-button",text:"OK"}}})}function popupLoading(){"use strict";$.confirm({title:"",message:"<img src='/ek-assets/responsive/img/ajax-loader.gif' style='display: block;margin-left: auto;margin-right: auto;' /><br>资料传送中......"})}function CheckInput(){"use strict";var e=document.getElementById("ctl00_ContentPlaceHolder1_txt_sDesx").innerHTML;document.getElementById("ctl00_ContentPlaceHolder1_txt_sDesx").innerHTML=e.replace(/<[^>].*?>/g,"")}function ajaxVipCheck(e){"use strict";$(".validate-card-submit").css({display:"none"}),$(".loading-spin.vip-check").css({display:"inline-block"}),$.ajax({url:e,dataType:"html",type:"POST",error:function(){new ErrorVipChecking,$(".validate-card-submit").css({display:"inline-block"}),$(".loading-spin.vip-check").hide()},success:function(e){var t=e,a=t.split(",");if("Error"===t)new ErrorVipChecking,$(".validate-card-submit").css({display:"inline-block"}),$(".loading-spin.vip-check").hide();else if("0"===a[0])popupAlertMsg("验证失败","您的卡号验证失败，如需服务请洽<a href='http://www.htc.com/cn/contact/email/'>客服人员</a> "),$(".validate-card-submit").css({display:"inline-block"}),$(".loading-spin.vip-check").hide();else{if("0"===a[1]?($(".checkbox").hide(),$(".needactivate").show()):($(".checkbox").show(),$(".needactivate").hide()),$("#ctl00_ContentPlaceHolder1_txtVipCardNumber").attr("readonly","readonly"),$("#ctl00_ContentPlaceHolder1_txt_IMEI_SN").attr("readonly","readonly"),$("#ctl00_ContentPlaceHolder1_VCode").attr("readonly","readonly"),"home"===$("#ServiceType").val())"H"===a[2]?(popupAlertMsg("验证失败","亲，乐享版不适应于快递上门取送机服务哦^_^，请选择<br/>到店维修"),$(".validate-card-submit").css({display:"inline-block"}),$(".loading-spin.vip-check").hide()):($(".appointment-btn.get-phone").hide(),$(".four-steps-address").show(),region_init("select_province","select_city","select_area"),$("#addressprovince").val($("#select_province :selected").text()),$("#addresscity").val($("#select_city :selected").text()),$("#addressdistrict").val($("#select_area :selected").text()),$("#select_province").change(function(){$("#addressprovince").val($("#select_province :selected").text())}),$("#select_city").change(function(){$("#addresscity").val($("#select_city :selected").text())}),$("#select_area").change(function(){$("#addressdistrict").val($("#select_area :selected").text())}),$(".steps-enter-user-info").show(100,function(){var e=$(this);$("html, body").animate({scrollTop:e.offset().top-$(".d-header").height()},300)}),popupAlertMsg("验证成功","请继续填入您的收件资料"));else{$(".appointment-btn.in-home").hide(),$(".four-steps-address").hide(),popupAlertMsg("验证成功","请选择离您最近的网点");var i=$("#ctl00_ContentPlaceHolder1_sCity").find("option:selected").text();$("#shoparea").show();var n=0;$(".shoplist").each(function(){$(this).attr("id")===i?(0===n&&($(".shoplist").removeClass("selected"),$(this).children("label").children("input").prop("checked",!0),$(this).addClass("selected")),$(this).addClass("show"),$(this).children("label").children(".eng-title").html(new GetABC(n)),n+=1):$(this).removeClass("show")}),$("#map").show(),new BuildMap,$(".steps-select-store-info").show(100,function(){var e=$(this);$("html, body").animate({scrollTop:e.offset().top-$(".d-header").height()},300)})}$(".loading-spin.vip-check").hide(),addValidateRule()}}})}function ErrorVipChecking(){"use strict";popupAlertMsg("验证错误","目前VIP验证机制暂时无法使用，我们正在全力修復中请，如需紧急服务请洽<a href='http://www.htc.com/cn/contact/email/'>客服人员</a> ")}function Submit(){"use strict";__doPostBack("ctl00_ContentPlaceHolder1_lb_submit","")}function disableLink(e){"use strict";return e.preventDefault(),!1}function GetABC(e){"use strict";return["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"][e]}function BuildMap(){"use strict";var e=$("input[name=rdShop]:checked").val();$("#shopid").val(e);var t=$("#shop"+e).text().replace(" - ","#"),a=(t.split("#"),$("#shop"+e).children("div .location-title").html()),i=$("#shop"+e).children("div .location-text").html(),n=new BMap.Map("map");n.reset();var s={type:BMAP_NAVIGATION_CONTROL_LARGE};n.addControl(new BMap.NavigationControl(s)),(new BMap.Geocoder).getPoint(i,function(e){if(e){n.centerAndZoom(e,16);var t=new BMap.Marker(e);n.addOverlay(t);var i=new BMap.Label(a,{offset:new BMap.Size(-17,-40)});t.setLabel(i)}},"")}var vcode="";$("#ServiceType").val("home"),$("#ctl00_ContentPlaceHolder1_lb_submit").click(function(){"use strict";$("#addressprovince").val($("#select_province :selected").text()),$("#addresscity").val($("#select_city :selected").text()),$("#addressdistrict").val($("#select_area :selected").text())});var vipCardService=function(){"use strict";var e={init:function(){e.setupAppointmentButton(),e.setupGetPhoneButton(),e.setupVcodeFunction(),e.setupVoiceVcodeFunction(),e.initCardValidate(),e.setupCardSubmit(),e.setupDataSubmit(),new ReflashValidateImage},setupAppointmentButton:function(){$(".appointment-btn.in-home").on("click",function(e){e.preventDefault(),$("#ServiceType").val("home"),$(".steps-vip-card-info").show(100,function(){var e=$(this);$("html, body").animate({scrollTop:e.offset().top-$(".d-header").height()},300)})})},setupGetPhoneButton:function(){$(".appointment-btn.get-phone").on("click",function(e){e.preventDefault(),$("#ServiceType").val("store"),$(".steps-vip-card-info").show(100,function(){var e=$(this);$("html, body").animate({scrollTop:e.offset().top-$(".d-header").height()},300)})}),$("#ctl00_ContentPlaceHolder1_dlAllCity option").each(function(){$(this).val().indexOf("[44]")>=0&&$("<option />",{val:this.value,text:this.text}).appendTo($("#ctl00_ContentPlaceHolder1_sCity"))}),$("#ctl00_ContentPlaceHolder1_sCity").change(function(){if("--"!==$(this).val()){$("#shoparea").show(),$("input[name=rdShop]:checked").prop("checked",!1);var e=$(this).find("option:selected").text(),t=0;$(".shoplist").each(function(){$(this).attr("id")===e?(0===t&&($(this).children("label").children("input").prop("checked",!0),$(".shoplist").removeClass("selected"),$(this).addClass("selected")),$(this).children("label").children(".eng-title").html(new GetABC(t)),$(this).addClass("show"),t+=1):$(this).removeClass("show")}),$("#map").show(),new BuildMap}}),$(".shoplist").click(function(e){e.preventDefault(),$(".shoplist").removeClass("selected"),$(this).addClass("selected"),$(this).children("label").children("input[type=radio]").attr("checked","checked"),$("#map").show(),new BuildMap}),$("#btnNextInputData").click(function(e){e.preventDefault(),$(".steps-enter-user-info").show(100,function(){var e=$(this);$("html, body").animate({scrollTop:e.offset().top-$(".d-header").height()},300)})})},setupVcodeFunction:function(){$.ajax({url:"/cn/support/captcahimg.aspx?act=ref&res=v",dataType:"html",type:"POST",error:function(){},success:function(e){vcode=e,$("#ctl00_ContentPlaceHolder1_Image1").attr("src","/cn/support/captcahimg.aspx?"+Math.random())}}),$("#reloadicon").on("click",function(){$.ajax({url:"/cn/support/captcahimg.aspx?act=ref&res=v",dataType:"html",type:"POST",error:function(){},success:function(e){vcode=e,$("#ctl00_ContentPlaceHolder1_Image1").attr("src","/cn/support/captcahimg.aspx?"+Math.random())}})})},setupVoiceVcodeFunction:function(){$("#speaker").on("click",function(){$("#voicecaptcha").attr("src","/cn/support/captcahvoice.aspx?vcode="+vcode);var e=$("#voicecaptcha")[0];return e.load(),e.play(),!1}),$("#voicecaptcha").bind("play",function(){$(".speaker-icon-area").hide(),$(".loading-spin.captcha-play").css({display:"inline-block"})}),$("#voicecaptcha").bind("ended",function(){$(".loading-spin.captcha-play").hide(),$(".speaker-icon-area").show()})},setupDescCheck:function(){$("#ctl00_ContentPlaceHolder1_txt_sDesx").maxlength({maxCharacters:1e3,statusText:"剩餘字元",slider:!0})},setupCardSubmit:function(){$(".validate-card-submit").on("click",function(e){if(e.preventDefault(),!1===$("#aspnetForm").valid())return!1;var t=$("#ctl00_ContentPlaceHolder1_txt_IMEI_SN").val(),a="",i="";t.length>12?a=t:i=t,ajaxVipCheck("/cn/support/vipreservationws.aspx?imei="+a+"&sn="+i+"&card="+$("#ctl00_ContentPlaceHolder1_txtVipCardNumber").val())})},setupDataSubmit:function(){$("#ctl00_ContentPlaceHolder1_lb_submit").on("click",function(e){if(e.preventDefault(),!1===$("#aspnetForm").valid())return!1;$("#ctl00_ContentPlaceHolder1_lb_submit").removeClass("button"),$("#ctl00_ContentPlaceHolder1_lb_submit").bind("click",disableLink),$("#ctl00_ContentPlaceHolder1_lb_submit").addClass("button_gray"),popupLoading(),__doPostBack("ctl00$ContentPlaceHolder1$lb_submit","")})},initCardValidate:function(){$.validator.addMethod("vcodevalidate",function(e,t){return t.value.toLowerCase()===vcode.toLowerCase()}),$.validator.addMethod("vipcard",function(e,t){return!!/^(?:[A-Za-z0-9]{11})$/.test(e)}),jQuery.validator.addMethod("emailformat",function(e,t){if(this.optional(t))return!0;for(var a=e.split(/[;,]+/),i=!0,n=0;n<a.length;n++){var s=a[n];i=i&&jQuery.validator.methods.email.call(this,$.trim(s),t)}return i},jQuery.validator.messages.multiemails),$.validator.addMethod("specialchars",function(e,t){return!/[`~!@#$%^&*\(\)-\+=\^\[\]\{\}"?\/:;,]+/.test(e)}),$.validator.addMethod("specialcharsaddress",function(e,t){return!/[`~!@#$%^&*\+=\^\[\]\{\}"?\/:;]+/.test(e)}),$.validator.addMethod("imei",function(e,t){return!!/^(?:[0-9]{14}|[0-9]{15}|[A-Za-z0-9]{12}|)$/.test(e)}),$.validator.addMethod("numberonly",function(e,t){return!!/^(\s*|[0-9\-#()+])+$/.test(e)}),$("#aspnetForm").validate({errorClass:"error up"})}};return e}();$(document).ready(function(){"use strict";vipCardService.init(),region_init("select_province","select_city","select_area")}),$(window).resize(function(){});